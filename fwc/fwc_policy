#!/usr/bin/python

policies = []

# Fromzone, Tozone, protocol
policies.append(["labnet", "local", "ssh"])
policies.append(["labnet", "local", "http"])
policies.append(["labnet", "local", "ping"])
policies.append(["labnet", "local", "dhcp"])

policies.append(["sdunet", "local", "https"])

# Labvpn in
policies.append(["labvpn", "local", "ping"])

# SDUDMZ in - permit openvpn in
policies.append(["sdudmznet", "local", "https"]);


policies.append(["local", "labnet", "dhcp"])



# Permit everything outgoing, but only established back
policies.append(["labnet", "sdunet", "all"])

# Rules concerning the firewall
policies.append(["local", "sdunet", "http"])
policies.append(["local", "sdunet", "https"])
policies.append(["local", "sdunet", "dns"])
policies.append(["local", "sdunet", "ntp"])
policies.append(["local", "sdunet", "dhcp"])


# Rules concerning labpvn
policies.append(["labnet", "labvpn", "all"])
policies.append(["labvpn", "labnet", "all"])


print "# This script is autogenerated. Changes will be overwritten"
for policy in policies:
    fromZone = policy[0].title()
    toZone = policy[1].title()
    proto = policy[2]

    tmp = [fromZone, "To", toZone]

    print "$iptables -A " + "".join(tmp) + " -j " + proto + "-c2s"
    print "$iptables -A " + "".join(tmp[::-1]) + " -j " + proto + "-s2c"
